
<!DOCTYPE HTML>
<html>
<head>
	<meta charset="utf-8">
	<title>Refactoring... a Weighty Question - Civet</title>
	<meta name="author" content="Zander">

	
	<meta name="description" content="Refactoring. .. a Weighty Question I&#8217;ve been working on a library for easily exporting Trello information to CSV, TSV, and XLSX. It&#8217;s &hellip;">
	

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

	<link href="/atom.xml" rel="alternate" title="Civet" type="application/atom+xml">
	
	<link rel="canonical" href="http://zph.github.io/blog/2012/12/18/refactoring-a-weighty-question/">
	<link href="/favicon.png" rel="shortcut icon">
	<link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
	<!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
	<script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
	<link href='http://fonts.googleapis.com/css?family=Open+Sans:400italic,400,700' rel='stylesheet' type='text/css'>
	<!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

</head>


<body>
	<div class="container">
		<div class="left-col">
			<div class="intrude-less">
			<header id="header" class="inner"><div class="profilepic">	
	<script src="/javascripts/md5.js"></script>
	<script type="text/javascript">
		$(function(){
			$('.profilepic').append("<img src='http://www.gravatar.com/avatar/" + MD5("zander@civet.ws") + "?s=160' alt='Profile Picture' style='width: 160px;' />");
		});
	</script>
</div>
<hgroup>
  <h1><a href="/">Civet</a></h1>
  
    <h2>The Spice of Life</h2>
  
</hgroup>

<p class="subtitle">The Spice of Life</p>
<nav id="main-nav">
</nav>
<nav id="sub-nav">
	<div class="social">
		
		
		
		<a class="twitter" href="http://twitter.com/_ZPH" title="Twitter">Twitter</a>
		
		
		<a class="github" href="https://github.com/ZPH" title="GitHub">GitHub</a>
		
		
		
		
		
		
		
		<a class="rss" href="/atom.xml" title="RSS">RSS</a>
		
	</div>
</nav>
</header>				
			</div>
		</div>	
		<div class="mid-col">
			
				
			
			<div class="mid-col-container">
				<div id="content" class="inner"><article class="post" itemscope itemtype="http://schema.org/BlogPosting">
	<h1 class="title" itemprop="name">Refactoring. .. a Weighty Question</h1>
	<div class="entry-content" itemprop="articleBody">I&#8217;ve been working on a library for easily exporting <a href="www.trello.com">Trello</a> information to CSV, TSV, and XLSX. It&#8217;s currently working well for all three formats although the code itself is first or second draft quality. (Not that XLSX has some issues of its own when done from Ruby. I&#8217;d like to solve it eventually but it&#8217;s on the back seat since the files still open.)
I took the time to import it into CodeClimate&#8217;s automated test system to see where potential issues are.

It revealed that one particular set of methods was far too complex. These were the methods that generate the CSV or XLSX file.

I sat down to refactor them while under the weather this weekend and here&#8217;s what I accomplished:

-Extracted code out into methods (needs more of this as methods don&#8217;t have single responsibilities)
-Abstracted the process into a single uber method that calls submethods (could be private methods later in development)
-In order to abstract the process to be identical for CSV and XLSX, I found one spot that needed an [cci_ruby]eval(content)[/cci_ruby] statement. ( Perhaps in the future I can adapt a lambda to better suit this purpose?? )

Here are the different versions of it:

Before-<script type="text/javascript" src="https://gist.github.com/4330951.js"></script>

After-<script type="text/javascript" src="https://gist.github.com/4330957.js"></script>

Diff-<script type="text/javascript" src="https://gist.github.com/4331152.js"></script>

Looking at it again I want to extract the different classes into their own files for better compartmentalizing the code.

Let me know in the comments what code smells are present or what refactorings are still advised.

<!-- #VIMREPRESS_TAG# http://198.211.104.146/wp-content/uploads/2012/12/vimrepress_50d0c28d_mkd.odt vimrepress_50d0c28d_mkd.odt -->
</div>

</article>

	<div class="share">
	<div class="addthis_toolbox addthis_default_style ">
	
	
	<a class="addthis_button_tweet"></a>
	
	
	<a class="addthis_counter addthis_pill_style"></a>
	</div>
  <script type="text/javascript" src="http://s7.addthis.com/js/250/addthis_widget.js#pubid="></script>
</div>


</div>
			</div>
			<footer id="footer" class="inner"><p class="pull-left">
  <a href="/">Civet</a>
  - Copyright &copy; 2013 - Zander
</p>
<p class="pull-right">
  <span>Powered by <a href="http://octopress.org/">Octopress</a>.</span>
  
    <span>Designed by <a href="http://www.AdrianArtiles.com">Adrian Artiles</a>.</span>
  
</p>

Design credit: <a href="http://shashankmehta.in/archive/2012/greyshade.html">Shashank Mehta</a></footer>
			<script src="/javascripts/slash.js"></script>
<script src="/javascripts/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
	$('.fancybox').fancybox();
})(jQuery);
</script> <!-- Delete or comment this line to disable Fancybox -->













  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>



		</div>
	</div>
</body>
</html>
